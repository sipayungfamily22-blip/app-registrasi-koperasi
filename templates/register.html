{% extends "base.html" %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-lg-10">
        <div class="card shadow">
            <div class="card-header bg-primary text-white">
                <h4 class="mb-0">Formulir Pendaftaran Calon Anggota Koperasi</h4>
            </div>
            <div class="card-body">
                <form method="POST" enctype="multipart/form-data">
                    <h5 class="border-bottom pb-2">Data Pribadi</h5>
                    <div class="row g-3">
                        <div class="col-md-6">
                            <label class="form-label">NAMA LENGKAP *</label>
                            <input type="text" class="form-control" name="nama_lengkap" required>
                        </div>
                        <div class="col-md-3">
                            <label class="form-label">TEMPAT LAHIR *</label>
                            <input type="text" class="form-control" name="tempat_lahir" required>
                        </div>
                        <div class="col-md-3">
                            <label class="form-label">TANGGAL LAHIR *</label>
                            <input type="date" class="form-control" name="tanggal_lahir" required>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label">ALAMAT RUMAH *</label>
                            <textarea class="form-control" name="alamat_rumah" rows="3" required></textarea>
                        </div>
                        <div class="col-md-3">
                            <label class="form-label">NOMOR HANDPHONE (WHATSAPP AKTIF) *</label>
                            <input type="tel" class="form-control" name="nomor_handphone" required>
                        </div>
                        <div class="col-md-3">
                            <label class="form-label">ALAMAT EMAIL *</label>
                            <input type="email" class="form-control" name="alamat_email" required>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label">NOMOR KTP *</label>
                            <input type="text" class="form-control" name="nomor_ktp" required>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label">NO ID KARYAWAN SILOAM TB SIMATUPANG *</label>
                            <input type="text" class="form-control" name="no_id_karyawan" required>
                        </div>
                    </div>

                    <h5 class="border-bottom pb-2 mt-4">Data Karyawan</h5>
                    <div class="row g-3">
                        <div class="col-md-6">
                            <label class="form-label">ASAL DEPARTEMEN *</label>
                            <select class="form-select" id="asal_departemen" name="asal_departemen" required onchange="toggleDepartemenLainnya()">
                                <option value="">Pilih Departemen</option>
                                {% for dept in departemen_options %}
                                    <option value="{{ dept }}">{{ dept }}</option>
                                {% endfor %}
                            </select>
                        </div>
                        <div class="col-md-6" id="departemen_lainnya_container" style="display: none;">
                            <label class="form-label">NAMA DEPARTEMEN LAINNYA *</label>
                            <input type="text" class="form-control" id="departemen_lainnya_input" name="departemen_lainnya" placeholder="Masukkan nama departemen">
                        </div>
                    </div>

                    <h5 class="border-bottom pb-2 mt-4">Data Rekening</h5>
                    <div class="row g-3">
                        <div class="col-md-6">
                            <label class="form-label">NOMOR REKENING *</label>
                            <input type="text" class="form-control" name="nomor_rekening" required>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label">NAMA BANK *</label>
                            <input type="text" class="form-control" name="nama_bank" required>
                        </div>
                    </div>

                    <h5 class="border-bottom pb-2 mt-4">Upload Dokumen</h5>
                    <div class="row g-3">
                        <div class="col-md-6">
                            <label class="form-label">UPLOAD KTP (jpg/png/pdf) *</label>
                            <input type="file" class="form-control" name="upload_ktp" accept=".jpg,.jpeg,.png,.pdf" required>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label">UPLOAD ID KARYAWAN (jpg/png/pdf) *</label>
                            <input type="file" class="form-control" name="upload_id_karyawan" accept=".jpg,.jpeg,.png,.pdf" required>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label">UPLOAD PAS FOTO (jpg/png) *</label>
                            <input type="file" class="form-control" name="upload_pas_foto" accept=".jpg,.jpeg,.png" required>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label">UPLOAD BUKU TABUNGAN / BUKTI MOBILE REKENING (jpg/png/pdf) *</label>
                            <input type="file" class="form-control" name="upload_buku_tabungan" accept=".jpg,.jpeg,.png,.pdf" required>
                        </div>
                    </div>

                    <h5 class="border-bottom pb-2 mt-4">Persyaratan Menjadi Anggota KOPKAR SHTB *</h5>
                    <div class="alert alert-info" role="alert">
                        <strong>Perhatian:</strong> Anda wajib membaca dan menyetujui semua persyaratan berikut sebelum melanjutkan pendaftaran.
                    </div>
                    <div class="form-check mb-3">
                        <input class="form-check-input" type="checkbox" name="syarat_karyawan_aktif" id="syarat_karyawan_aktif" required>
                        <label class="form-check-label" for="syarat_karyawan_aktif">
                            Hanya untuk Karyawan Aktif RS Siloam Hospitals TB Simatupang (tidak berlaku untuk mitra/tenant/vendor)
                        </label>
                    </div>
                    <div class="form-check mb-3">
                        <input class="form-check-input" type="checkbox" name="syarat_potongan_gaji" id="syarat_potongan_gaji" required>
                        <label class="form-check-label" for="syarat_potongan_gaji">
                            Bersedia dipotong gaji untuk Simpanan Pokok (Setoran Awal) sebesar Rp 50.000,- dan Simpanan Wajib (bulanan) sebesar Rp 25.000,-
                        </label>
                    </div>
                    <div class="form-check mb-3">
                        <input class="form-check-input" type="checkbox" name="syarat_adart" id="syarat_adart" required>
                        <label class="form-check-label" for="syarat_adart">
                            Saya akan mematuhi AD/ART dan Peraturan Koperasi Karyawan Siloam Hospitals TB Simatupang
                        </label>
                    </div>
                    <div class="form-check mb-4">
                        <input class="form-check-input" type="checkbox" name="syarat_partisipasi" id="syarat_partisipasi" required>
                        <label class="form-check-label" for="syarat_partisipasi">
                            Saya akan berpartisipasi aktif dalam kegiatan dan program Koperasi untuk mendukung keberlanjutan usaha bersama
                        </label>
                    </div>

                    <h5 class="border-bottom pb-2 mt-4">Pernyataan</h5>
                    <div class="form-check mb-4">
                        <input class="form-check-input" type="checkbox" name="pernyataan" id="pernyataan" required>
                        <label class="form-check-label" for="pernyataan">
                            <strong>PERNYATAAN PEMOHON*</strong><br>
                            Dengan ini saya sebagai Calon Anggota menyetujui segala peraturan yang berlaku di Koperasi Karyawan RS Siloam Hospitals TB Simatupang dan jika di kemudian hari ada permasalahan dengan keanggotaan saya, maka saya serahkan kepada Pengurus untuk mengambil keputusan yang diperlukan sesuai peraturan yang berlaku.
                        </label>
                    </div>

                    <div class="d-grid gap-2">
                        <button type="submit" class="btn btn-primary btn-lg">Kirim Pendaftaran</button>
                        <a href="{{ url_for('index') }}" class="btn btn-secondary">Kembali</a>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<script>
function toggleDepartemenLainnya() {
    const selectedDept = document.getElementById('asal_departemen').value;
    const container = document.getElementById('departemen_lainnya_container');
    const input = document.getElementById('departemen_lainnya_input');
    
    if (selectedDept === 'Lainnya') {
        container.style.display = 'block';
        input.required = true;
    } else {
        container.style.display = 'none';
        input.required = false;
        input.value = '';
    }
}

// Validasi form sebelum submit
document.querySelector('form').addEventListener('submit', function(e) {
    const selectedDept = document.getElementById('asal_departemen').value;
    const input = document.getElementById('departemen_lainnya_input');
    
    if (selectedDept === 'Lainnya' && input.value.trim() === '') {
        e.preventDefault();
        alert('Silakan masukkan nama departemen lainnya');
        input.focus();
    }
});
</script>
{% endblock %}